(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33ba"],{"4aa5":function(t,e,o){},"760c":function(t,e,o){"use strict";var a=o("4aa5"),r=o.n(a);r.a},e4ca:function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"animated fadeIn"},[o("b-row",[o("b-col",{attrs:{sm:"12"}},[o("b-card",[o("div",{attrs:{slot:"header"},slot:"header"},[o("strong",[t._v("Detalles de Cronología")])]),o("b-row",[o("b-col",{attrs:{sm:"6"}},[o("b-form-group",{attrs:{description:"CC-"+t.port.clise,label:"Clise","laber-for":"clise",horizontal:!1}},[o("b-form-input",{attrs:{formatter:t.validateClise,disabled:"COMPLETADO"===t.receptionData.estado,type:"number",id:"clise"},model:{value:t.port.clise,callback:function(e){t.$set(t.port,"clise",e)},expression:"port.clise"}})],1)],1),o("b-col",{attrs:{sm:"6"}},[o("b-form-group",{attrs:{description:"K-18-0071-"+t.port.exp,label:"Exp","laber-for":"exp",horizontal:!1}},[o("b-form-input",{attrs:{formatter:t.validateExp,disabled:"COMPLETADO"===t.receptionData.estado,type:"number",id:"exp"},model:{value:t.port.exp,callback:function(e){t.$set(t.port,"exp",e)},expression:"port.exp"}})],1)],1)],1),o("b-row",[o("b-col",{attrs:{sm:"6"}},[o("b-form-group",{attrs:{description:"Ej: Armas Largas",label:"Tipo","laber-for":"tipo",horizontal:!1}},[o("b-form-input",{attrs:{type:"text",id:"tipo"},model:{value:t.port.tipo,callback:function(e){t.$set(t.port,"tipo",e)},expression:"port.tipo"}})],1)],1),o("b-col",{attrs:{sm:"6"}},[o("b-form-group",{attrs:{description:"Ej: Negro",label:"Color","laber-for":"color",horizontal:!1}},[o("b-form-input",{attrs:{formatter:t.onlyKey,type:"text",id:"color"},model:{value:t.port.color,callback:function(e){t.$set(t.port,"color",e)},expression:"port.color"}})],1)],1),o("b-col",{attrs:{sm:"6"}},[o("b-form-group",{attrs:{description:"Ej: 9mm",label:"Calibre","laber-for":"calibre",horizontal:!1}},[o("b-form-input",{attrs:{type:"text",id:"calibre"},model:{value:t.port.calibre,callback:function(e){t.$set(t.port,"calibre",e)},expression:"port.calibre"}})],1)],1),o("b-col",{attrs:{sm:"6"}},[o("b-form-group",{attrs:{description:"Ej: 20cm",label:"Longitud de Cañon:","laber-for":"longitud_cañon",horizontal:!1}},[o("b-form-input",{attrs:{type:"text",id:"longitud_cañon"},model:{value:t.port.longitud_cañon,callback:function(e){t.$set(t.port,"longitud_cañon",e)},expression:"port.longitud_cañon"}})],1)],1),o("b-col",{attrs:{sm:"6"}},[o("b-form-group",{attrs:{description:"Ej: 367mm",label:"Dimensiones","laber-for":"dimensiones",horizontal:!1}},[o("b-form-input",{attrs:{type:"text",id:"dimensiones"},model:{value:t.port.dimensiones,callback:function(e){t.$set(t.port,"dimensiones",e)},expression:"port.dimensiones"}})],1)],1),o("b-col",{attrs:{sm:"6"}},[o("b-form-group",{attrs:{description:"Ej: 1kg",label:"Peso","laber-for":"peso",horizontal:!1}},[o("b-form-input",{attrs:{type:"text",id:"peso"},model:{value:t.port.peso,callback:function(e){t.$set(t.port,"peso",e)},expression:"port.peso"}})],1)],1),o("b-col",{attrs:{sm:"6"}},[o("b-form-group",{attrs:{description:"Ej: 1kg",label:"Peso Cargador","laber-for":"peso_cargador",horizontal:!1}},[o("b-form-input",{attrs:{type:"text",id:"peso_cargador"},model:{value:t.port.peso_cargador,callback:function(e){t.$set(t.port,"peso_cargador",e)},expression:"port.peso_cargador"}})],1)],1),o("b-col",{attrs:{sm:"6"}},[o("b-form-group",{attrs:{description:"Ej: Abierta",label:"Miras","laber-for":"miras",horizontal:!1}},[o("b-form-input",{attrs:{type:"text",id:"miras"},model:{value:t.port.miras,callback:function(e){t.$set(t.port,"miras",e)},expression:"port.miras"}})],1)],1)],1),o("b-row",[o("b-col",{attrs:{sm:"6"}},[o("b-form-group",{attrs:{description:"Ej: 6 balas",label:"Capacidad Cargador","laber-for":"capacidad_cargador",horizontal:!1}},[o("b-form-input",{attrs:{type:"number",id:"capacidad_cargador"},model:{value:t.port.capacidad_cargador,callback:function(e){t.$set(t.port,"capacidad_cargador",e)},expression:"port.capacidad_cargador"}})],1)],1),o("b-col",{attrs:{sm:"6"}},[o("b-form-group",{attrs:{description:"Ej: Automático",label:"Disparador","laber-for":"disparador",horizontal:!1}},[o("b-form-input",{attrs:{formatter:t.onlyKey,type:"text",id:"disparador"},model:{value:t.port.disparador,callback:function(e){t.$set(t.port,"disparador",e)},expression:"port.disparador"}})],1)],1)],1),o("b-row",[o("b-col",{attrs:{sm:"12"}},[o("b-form-group",{attrs:{label:"Comentario","laber-for":"comentarios",horizontal:!1}},[o("b-form-textarea",{staticClass:"form-control",attrs:{rows:"5"},model:{value:t.port.comentarios,callback:function(e){t.$set(t.port,"comentarios",e)},expression:"port.comentarios"}})],1)],1)],1)],1),o("b-card",[o("div",{attrs:{slot:"header"},slot:"header"},[o("strong",[t._v("Imágenes")])]),o("b-row",[o("b-col",{attrs:{sm:"12"}},[o("div",{staticClass:"wrapper"},[o("gallery",{attrs:{images:t.images,index:t.index},on:{close:function(e){t.index=null}}}),t._l(t.images,function(e,a){return o("div",{key:a,staticClass:"image",class:["image",t.index==a?"selected":""],style:{backgroundImage:"url("+e+")",width:"100%",height:"300px"},on:{click:function(e){t.index=a}}})})],2),o("vue-dropzone",{ref:"myVueDropzone",attrs:{id:"dropzone",options:t.dropzoneOptions},on:{"vdropzone-success":t.reloadImages,"vdropzone-sending":t.sendingEvent}})],1)],1)],1),o("b-card",[o("div",{attrs:{slot:"header"},slot:"header"},[o("strong",[t._v("Datos de Recepción")])]),t.loading?t._e():o("b-row",[o("b-col",{attrs:{sm:"6"}},[o("b-form-group",{attrs:{label:"Tipo","laber-for":"tipo_recepcion",disabled:!0,horizontal:!1}},[o("b-form-input",{staticClass:"form-control",attrs:{disabled:"",value:t.receptionData.tipo_recepcion,type:"text",id:"clise"}})],1)],1),o("b-col",{attrs:{sm:"6"}},[o("b-form-group",{attrs:{label:"Funcionario",disabled:!0,horizontal:!1}},[o("b-form-input",{staticClass:"form-control",attrs:{disabled:"",value:t.receptionData.Usuario.nombre+" "+t.receptionData.Usuario.apellido,type:"text"}})],1)],1),o("b-col",{attrs:{sm:"12"}},[o("b-form-group",{attrs:{label:"Descripción","laber-for":"Descripción",disabled:!0,horizontal:!1}},[o("b-form-textarea",{staticClass:"form-control",attrs:{disabled:"",value:t.receptionData.descripcion,rows:"5"}})],1)],1)],1)],1),o("div",{staticClass:"form-actions padding"},[t.isNew?o("b-button",{staticClass:"mr",attrs:{type:"submit",variant:"primary"},on:{click:function(e){t.storeArm()}}},[t._v("\n          Crear\n        ")]):t._e(),t.isNew?t._e():o("b-button",{staticClass:"mr",attrs:{type:"submit",variant:"primary"},on:{click:function(e){t.updateArm()}}},[t._v("\n          Actualizar\n        ")]),o("b-button",{staticClass:"mr",attrs:{type:"button",variant:"secondary"},on:{click:function(e){t.$router.go(-1)}}},[t._v("\n          Cancelar\n        ")]),"EN_PROCESO"===t.receptionData.estado?o("b-button",{staticClass:"mr",attrs:{disabled:"COMPLETADO"===t.receptionData,type:"button",variant:"primary"},on:{click:function(e){t.onChangeStatus()}}},[t._v("\n          Marcar Como Procesada\n        ")]):t._e(),t._v("\n        Estado: "+t._s(t.receptionData.estado)+"\n      ")],1)],1)],1)],1)},r=[],i=(o("4917"),o("7f7f"),o("f751"),o("ac6a"),o("28a5"),o("cadf"),o("551c"),o("92c3")),s=o.n(i),n=(o("1e3f"),o("067c")),c=o.n(n),l=o("db49"),p=o("1940"),d=o.n(p),u=(o("07a4"),{components:{vueDropzone:s.a,gallery:c.a},data:function(){return{users:[],user:{},port:{},receptionData:{},images:[],index:null,isNew:!1,loading:!0,dropzoneOptions:{url:"".concat(l["a"].API_URL,"/pictures"),dictDefaultMessage:"CARGAR IMAGEN",headers:{authorization:localStorage.getItem("token")}}}},mounted:function(){var t=this;this.user=this.$store.getters.user,axios.defaults.headers.common["authorization"]=localStorage.getItem("token"),this.armExist().then(function(e){if(t.isEmpty(e.data.data))t.isNew=!0;else{t.isNew=!1;var o=e.data.data.clise.split("-")[1],a=e.data.data.exp.split("-")[3];t.port=e.data.data,t.port.clise=o,t.port.exp=a,t.port.Evidencium.Imagens.forEach(function(e){var o="".concat(l["a"].API_IMAGE,"/").concat(e.nombre_archivo);t.images.push(o)})}}),this.getUsers(),this.getEvidence()},methods:{armExist:function(){var t=this;return new Promise(function(e,o){axios.get("".concat(l["a"].API_URL,"/evidences/").concat(t.$route.params.id,"/arms")).then(function(t){e(t)})})},storeArm:function(){var t=this;Object.assign(this.port,{evidencia_id:this.$route.params.id}),Object.assign(this.port,{clise:"CC-".concat(this.port.clise)}),Object.assign(this.port,{exp:"K-18-0071-".concat(this.port.exp)}),Event.$emit("loading"),axios.post("".concat(l["a"].API_URL,"/arms"),this.port).then(function(e){Event.$emit("stopLoading"),d()({title:"Item modificado exitosamente",text:"",icon:"success"}),t.$router.push({name:"chronologyList"})}).catch(function(t){Event.$emit("stopLoading"),"SequelizeDatabaseError"==t.response.data.name&&d()({title:"Atención",text:"Algo ha salido mal, intentelo nuevamente",icon:"error"}),t.response.data.message&&d()({title:"Atención",text:"".concat(t.response.data.message),icon:"error"}),t.response.data.errors.forEach(function(t){d()({title:"Atención",text:"".concat(t.message),icon:"error"})})})},updateArm:function(){var t=this;Object.assign(this.port,{clise:"CC-".concat(this.port.clise)}),Object.assign(this.port,{exp:"K-18-0071-".concat(this.port.exp)}),Event.$emit("loading"),axios.put("".concat(l["a"].API_URL,"/arms/").concat(this.port.id),this.port).then(function(e){Event.$emit("stopLoading"),d()({title:"Retrato modificado exitosamente",text:"",icon:"success"}),t.$router.push({name:"chronologyList"})}).catch(function(t){Event.$emit("stopLoading"),"SequelizeDatabaseError"==t.response.data.name&&d()({title:"Atención",text:"Algo ha salido mal, intentelo nuevamente",icon:"error"}),t.response.data.message&&d()({title:"Atención",text:"".concat(t.response.data.message),icon:"error"}),t.response.data.errors.forEach(function(t){d()({title:"Atención",text:"".concat(t.message),icon:"error"})})})},getUsers:function(){var t=this;axios.get("".concat(l["a"].API_URL,"/users?limit=1")).then(function(e){axios.get("".concat(l["a"].API_URL,"/users?limit=").concat(e.total)).then(function(e){t.users=e.data.data})})},getEvidence:function(){var t=this;this.loading=!0,axios.get("".concat(l["a"].API_URL,"/evidences/").concat(this.$route.params.id)).then(function(e){t.receptionData=e.data.data,t.loading=!1})},isEmpty:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return JSON.stringify(t)===JSON.stringify({})},sendingEvent:function(t,e,o){o.append("evidencia_id",this.$route.params.id),o.append("usuario_id",this.user.id)},reloadImages:function(t,e){this.images.push("".concat(l["a"].API_IMAGE,"/").concat(e.nombre_archivo))},onChangeStatus:function(){var t="COMPLETADO"==this.receptionData.estado?"EN_PROCESO":"COMPLETADO";return this.port.clise||"COMPLETADO"!=t?this.port.clise.length<5&&"COMPLETADO"==t?(d()({title:"Atención",text:"El campo clise debe contener 5 digitos",icon:"error"}),this.receptionData.estado="EN_PROCESO",""):this.port.clise.length>5&&"COMPLETADO"==t?(d()({title:"Atención",text:"El campo clise debe contener 5 digitos",icon:"error"}),this.receptionData.estado="EN_PROCESO",""):this.port.exp||"COMPLETADO"!=t?this.port.exp.length<6&&"COMPLETADO"==t?(d()({title:"Atención",text:"El campo exp debe contener 6 digitos",icon:"error"}),this.receptionData.estado="EN_PROCESO",""):this.port.exp.length>6&&"COMPLETADO"==t?(d()({title:"Atención",text:"El campo exp debe contener 6 digitos",icon:"error"}),this.receptionData.estado="EN_PROCESO",""):this.port.tipo||"COMPLETADO"!=t?this.images.length||"COMPLETADO"!=t?this.port.color||"COMPLETADO"!=t?this.port.calibre||"COMPLETADO"!=t?(this.receptionData.estado="COMPLETADO",Event.$emit("loading"),axios.put("".concat(l["a"].API_URL,"/evidences/").concat(this.receptionData.id),{estado:t}).then(function(e){console.log("Estado actualizado a ".concat(t)),Event.$emit("stopLoading")}).catch(function(t){Event.$emit("stopLoading"),console.dir(t)}),void(!0===this.isNew?this.storeArm():this.updateArm())):(this.showError("calibre"),this.receptionData.estado="EN_PROCESO",""):(this.showError("color"),this.receptionData.estado="EN_PROCESO",""):(this.showError("Imagenes"),this.receptionData.estado="EN_PROCESO",""):(this.showError("Tipo"),this.receptionData.estado="EN_PROCESO",""):(this.showError("exp"),this.receptionData.estado="EN_PROCESO",""):(this.receptionData.estado="EN_PROCESO",this.showError("clise"),"")},showError:function(t){d()({title:"Atención",text:"El campo ".concat(t," es requerido"),icon:"error"})},onlyKey:function(t,e){return null!=t.match(/^[a-zA-Z\s]*$/)?t:t.substr(0,t.length-1)},validateClise:function(t,e){return t.length<=5?t:t.substr(0,t.length-1)},validateExp:function(t,e){return t.length<=6?t:t.substr(0,t.length-1)}}}),m=u,b=(o("760c"),o("2877")),h=Object(b["a"])(m,a,r,!1,null,"ee61ed00",null);e["default"]=h.exports}}]);
//# sourceMappingURL=chunk-33ba.2fd1f9de.js.map